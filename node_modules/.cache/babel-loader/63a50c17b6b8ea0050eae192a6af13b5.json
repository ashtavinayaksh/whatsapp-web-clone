{"ast":null,"code":"var _jsxFileName = \"E:\\\\React_Project\\\\WhatsApp-Clone-React-isnotuploaded on github\\\\src\\\\App.js\",\n    _s = $RefreshSig$();\n\nimport React, { useEffect, useState } from \"react\";\nimport { useStateValue } from \"./StateProvider\";\nimport { BrowserRouter as Router, Switch, Route, Redirect } from \"react-router-dom\"; //importing firebase\n// import db from \"./firebase\";\n// import { auth, firebase } from \"./firebase\";\n//importing actions\n\nimport { setUser } from \"./actions/userAction\"; //importing components\n\nimport Login from \"./Login\";\nimport Sidebar from \"../src/Sidebar/Sidebar\";\nimport Chat from \"../src/Chat/Chat\";\nimport { ToastContainer } from \"react-toastify\";\nimport { toastInfo } from \"./shared/toastInfo\"; //importing material-ui\n\nimport Hidden from \"@material-ui/core/Hidden\";\nimport CircularProgress from \"@material-ui/core/CircularProgress\";\nimport LinearProgress from \"@material-ui/core/LinearProgress\"; //importing styles\n\nimport \"react-toastify/dist/ReactToastify.css\";\nimport \"./App.css\";\n\nfunction App() {\n  _s();\n\n  const [{\n    user\n  }, dispatch] = useStateValue();\n  const [rooms, setRooms] = useState([]);\n  const [isRoomExist, setIsRoomExist] = useState(\"\");\n  const [loading, setLoading] = useState(false);\n  useEffect(() => {\n    const unsubscribe = auth.onAuthStateChanged(authUser => {\n      if (authUser) {\n        dispatch(setUser(authUser));\n        setLoading(true);\n        db.collection(\"rooms\").orderBy(\"timestamp\", \"desc\").onSnapshot(snapshot => setRooms(snapshot.docs.map(doc => ({\n          id: doc.id,\n          data: doc.data()\n        }))));\n\n        if (authUser.isAnonymous === true && authUser.displayName === null) {\n          var anonymousName = \"Anonymous\" + \" \" + Math.floor(Math.random() * 1000000);\n          auth.currentUser.updateProfile({\n            displayName: anonymousName,\n            photoURL: \"\"\n          });\n          db.collection(\"users\").doc(authUser.uid).set({\n            name: anonymousName,\n            about: \"Hey there! I am using WhatsApp.\",\n            photoURL: \"\",\n            role: \"anonymous\",\n            dateJoined: firebase.firestore.FieldValue.serverTimestamp()\n          }).then(function () {\n            console.log(\"Document successfully updated!\");\n          }).catch(function (error) {\n            // The document probably doesn't exist.\n            console.error(\"Error updating document: \", error);\n          });\n        }\n\n        if (authUser.uid && authUser.isAnonymous === false && authUser.photoURL !== null) {\n          const errorAbout = \"errorAbout\";\n          db.collection(\"users\").doc(authUser.uid).get().then(function (doc) {\n            if (doc.exists) {// console.log(\"USER EXIST\");\n            } else {\n              db.collection(\"users\").doc(authUser.uid).set({\n                name: authUser.displayName,\n                about: \"Hey there! I am using WhatsApp.\",\n                photoURL: user.photoURL,\n                role: \"regular\",\n                dateJoined: firebase.firestore.FieldValue.serverTimestamp()\n              });\n            }\n          }).catch(function (error) {\n            toastInfo(`${error}`, errorAbout, \"top-center\");\n          });\n        } else if (authUser.uid && authUser.isAnonymous === false && authUser.photoURL === null) {\n          const errorAbout = \"errorAbout\";\n          db.collection(\"users\").doc(authUser.uid).get().then(function (doc) {\n            if (doc.exists) {\n              console.log(\"USER EXIST\");\n            } else {\n              db.collection(\"users\").doc(authUser.uid).set({\n                name: authUser.displayName,\n                about: \"Hey there! I am using WhatsApp.\",\n                photoURL: \"\",\n                role: \"regular\",\n                dateJoined: firebase.firestore.FieldValue.serverTimestamp()\n              });\n            }\n          }).catch(function (error) {\n            toastInfo(`${error}`, errorAbout, \"top-center\");\n          });\n        }\n      } else {\n        dispatch(setUser(null));\n        setLoading(true);\n      }\n    });\n    return () => {\n      unsubscribe();\n    };\n  }, [dispatch, user]);\n  return /*#__PURE__*/React.createElement(\"div\", {\n    className: `app ${loading === false && \"app-no-bg\"}`,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 143,\n      columnNumber: 5\n    }\n  }, loading ? /*#__PURE__*/React.createElement(React.Fragment, null, /*#__PURE__*/React.createElement(ToastContainer, {\n    position: \"top-center\",\n    autoClose: 5000,\n    newestOnTop: false,\n    closeOnClick: true,\n    rtl: false,\n    pauseOnFocusLoss: true,\n    draggable: true,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 146,\n      columnNumber: 11\n    }\n  }), !user ? /*#__PURE__*/React.createElement(Login, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 156,\n      columnNumber: 13\n    }\n  }) : /*#__PURE__*/React.createElement(\"div\", {\n    className: \"app__body\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 158,\n      columnNumber: 13\n    }\n  }, /*#__PURE__*/React.createElement(Router, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 159,\n      columnNumber: 15\n    }\n  }, /*#__PURE__*/React.createElement(Switch, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 160,\n      columnNumber: 17\n    }\n  }, /*#__PURE__*/React.createElement(Route, {\n    exact: true,\n    path: \"/\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 161,\n      columnNumber: 19\n    }\n  }, /*#__PURE__*/React.createElement(Sidebar, {\n    rooms: rooms,\n    setIsRoomExist: setIsRoomExist,\n    isRoomExist: isRoomExist,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 162,\n      columnNumber: 21\n    }\n  }), /*#__PURE__*/React.createElement(Hidden, {\n    only: [\"xs\"],\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 167,\n      columnNumber: 21\n    }\n  }, \" \", /*#__PURE__*/React.createElement(Chat, {\n    isRoomExist: isRoomExist,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 170,\n      columnNumber: 23\n    }\n  }))), /*#__PURE__*/React.createElement(Route, {\n    exact: true,\n    path: \"/rooms/:roomId\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 174,\n      columnNumber: 19\n    }\n  }, /*#__PURE__*/React.createElement(Hidden, {\n    only: [\"xs\"],\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 175,\n      columnNumber: 21\n    }\n  }, \" \", /*#__PURE__*/React.createElement(Sidebar, {\n    rooms: rooms,\n    setIsRoomExist: setIsRoomExist,\n    isRoomExist: isRoomExist,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 178,\n      columnNumber: 23\n    }\n  })), /*#__PURE__*/React.createElement(Chat, {\n    isRoomExist: isRoomExist,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 184,\n      columnNumber: 21\n    }\n  })), /*#__PURE__*/React.createElement(Route, {\n    path: \"*\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 187,\n      columnNumber: 19\n    }\n  }, /*#__PURE__*/React.createElement(Redirect, {\n    to: \"/\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 188,\n      columnNumber: 21\n    }\n  })))))) : /*#__PURE__*/React.createElement(\"div\", {\n    className: \"app__loading\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 196,\n      columnNumber: 9\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 197,\n      columnNumber: 11\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: \"app__loading_circular\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 198,\n      columnNumber: 13\n    }\n  }, /*#__PURE__*/React.createElement(CircularProgress, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 199,\n      columnNumber: 15\n    }\n  })), /*#__PURE__*/React.createElement(\"div\", {\n    className: \"app__loading_linear\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 201,\n      columnNumber: 13\n    }\n  }, /*#__PURE__*/React.createElement(LinearProgress, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 202,\n      columnNumber: 15\n    }\n  })))));\n}\n\n_s(App, \"Q3/TNoT3t7mp8/WwNESa6Wzxlp4=\", false, function () {\n  return [useStateValue];\n});\n\n_c = App;\nexport default App;\n\nvar _c;\n\n$RefreshReg$(_c, \"App\");","map":{"version":3,"sources":["E:/React_Project/WhatsApp-Clone-React-isnotuploaded on github/src/App.js"],"names":["React","useEffect","useState","useStateValue","BrowserRouter","Router","Switch","Route","Redirect","setUser","Login","Sidebar","Chat","ToastContainer","toastInfo","Hidden","CircularProgress","LinearProgress","App","user","dispatch","rooms","setRooms","isRoomExist","setIsRoomExist","loading","setLoading","unsubscribe","auth","onAuthStateChanged","authUser","db","collection","orderBy","onSnapshot","snapshot","docs","map","doc","id","data","isAnonymous","displayName","anonymousName","Math","floor","random","currentUser","updateProfile","photoURL","uid","set","name","about","role","dateJoined","firebase","firestore","FieldValue","serverTimestamp","then","console","log","catch","error","errorAbout","get","exists"],"mappings":"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","sourcesContent":["import React, { useEffect, useState } from \"react\";\r\nimport { useStateValue } from \"./StateProvider\";\r\nimport {\r\n  BrowserRouter as Router,\r\n  Switch,\r\n  Route,\r\n  Redirect,\r\n} from \"react-router-dom\";\r\n\r\n//importing firebase\r\n// import db from \"./firebase\";\r\n// import { auth, firebase } from \"./firebase\";\r\n\r\n//importing actions\r\nimport { setUser } from \"./actions/userAction\";\r\n//importing components\r\nimport Login from \"./Login\";\r\nimport Sidebar from \"../src/Sidebar/Sidebar\";\r\nimport Chat from \"../src/Chat/Chat\";\r\nimport { ToastContainer } from \"react-toastify\";\r\nimport { toastInfo } from \"./shared/toastInfo\";\r\n//importing material-ui\r\nimport Hidden from \"@material-ui/core/Hidden\";\r\nimport CircularProgress from \"@material-ui/core/CircularProgress\";\r\nimport LinearProgress from \"@material-ui/core/LinearProgress\";\r\n//importing styles\r\nimport \"react-toastify/dist/ReactToastify.css\";\r\nimport \"./App.css\";\r\n\r\nfunction App() {\r\n  const [{ user }, dispatch] = useStateValue();\r\n  const [rooms, setRooms] = useState([]);\r\n  const [isRoomExist, setIsRoomExist] = useState(\"\");\r\n  const [loading, setLoading] = useState(false);\r\n\r\n  useEffect(() => {\r\n    const unsubscribe = auth.onAuthStateChanged((authUser) => {\r\n      if (authUser) {\r\n        dispatch(setUser(authUser));\r\n        setLoading(true);\r\n\r\n        db.collection(\"rooms\")\r\n          .orderBy(\"timestamp\", \"desc\")\r\n          .onSnapshot((snapshot) =>\r\n            setRooms(\r\n              snapshot.docs.map((doc) => ({\r\n                id: doc.id,\r\n                data: doc.data(),\r\n              }))\r\n            )\r\n          );\r\n\r\n        if (authUser.isAnonymous === true && authUser.displayName === null) {\r\n          var anonymousName =\r\n            \"Anonymous\" + \" \" + Math.floor(Math.random() * 1000000);\r\n\r\n          auth.currentUser.updateProfile({\r\n            displayName: anonymousName,\r\n            photoURL: \"\",\r\n          });\r\n\r\n          db.collection(\"users\")\r\n            .doc(authUser.uid)\r\n            .set({\r\n              name: anonymousName,\r\n              about: \"Hey there! I am using WhatsApp.\",\r\n              photoURL: \"\",\r\n              role: \"anonymous\",\r\n              dateJoined: firebase.firestore.FieldValue.serverTimestamp(),\r\n            })\r\n            .then(function () {\r\n              console.log(\"Document successfully updated!\");\r\n            })\r\n            .catch(function (error) {\r\n              // The document probably doesn't exist.\r\n              console.error(\"Error updating document: \", error);\r\n            });\r\n        }\r\n\r\n        if (\r\n          authUser.uid &&\r\n          authUser.isAnonymous === false &&\r\n          authUser.photoURL !== null\r\n        ) {\r\n          const errorAbout = \"errorAbout\";\r\n          db.collection(\"users\")\r\n            .doc(authUser.uid)\r\n            .get()\r\n            .then(function (doc) {\r\n              if (doc.exists) {\r\n                // console.log(\"USER EXIST\");\r\n              } else {\r\n                db.collection(\"users\").doc(authUser.uid).set({\r\n                  name: authUser.displayName,\r\n                  about: \"Hey there! I am using WhatsApp.\",\r\n                  photoURL: user.photoURL,\r\n                  role: \"regular\",\r\n                  dateJoined: firebase.firestore.FieldValue.serverTimestamp(),\r\n                });\r\n              }\r\n            })\r\n            .catch(function (error) {\r\n              toastInfo(`${error}`, errorAbout, \"top-center\");\r\n            });\r\n        } else if (\r\n          authUser.uid &&\r\n          authUser.isAnonymous === false &&\r\n          authUser.photoURL === null\r\n        ) {\r\n          const errorAbout = \"errorAbout\";\r\n          db.collection(\"users\")\r\n            .doc(authUser.uid)\r\n            .get()\r\n            .then(function (doc) {\r\n              if (doc.exists) {\r\n                console.log(\"USER EXIST\");\r\n              } else {\r\n                db.collection(\"users\").doc(authUser.uid).set({\r\n                  name: authUser.displayName,\r\n                  about: \"Hey there! I am using WhatsApp.\",\r\n                  photoURL: \"\",\r\n                  role: \"regular\",\r\n                  dateJoined: firebase.firestore.FieldValue.serverTimestamp(),\r\n                });\r\n              }\r\n            })\r\n            .catch(function (error) {\r\n              toastInfo(`${error}`, errorAbout, \"top-center\");\r\n            });\r\n        }\r\n      } else {\r\n        dispatch(setUser(null));\r\n        setLoading(true);\r\n      }\r\n    });\r\n\r\n    return () => {\r\n      unsubscribe();\r\n    };\r\n  }, [dispatch, user]);\r\n\r\n  return (\r\n    <div className={`app ${loading === false && \"app-no-bg\"}`}>\r\n      {loading ? (\r\n        <>\r\n          <ToastContainer\r\n            position=\"top-center\"\r\n            autoClose={5000}\r\n            newestOnTop={false}\r\n            closeOnClick\r\n            rtl={false}\r\n            pauseOnFocusLoss\r\n            draggable\r\n          />\r\n          {!user ? (\r\n            <Login />\r\n          ) : (\r\n            <div className=\"app__body\">\r\n              <Router>\r\n                <Switch>\r\n                  <Route exact path=\"/\">\r\n                    <Sidebar\r\n                      rooms={rooms}\r\n                      setIsRoomExist={setIsRoomExist}\r\n                      isRoomExist={isRoomExist}\r\n                    />\r\n                    <Hidden only={[\"xs\"]}>\r\n                      {\" \"}\r\n                      {/* Chat component will be hidden in mobile view */}\r\n                      <Chat isRoomExist={isRoomExist} />\r\n                    </Hidden>\r\n                  </Route>\r\n\r\n                  <Route exact path=\"/rooms/:roomId\">\r\n                    <Hidden only={[\"xs\"]}>\r\n                      {\" \"}\r\n                      {/* Sidebar component will be hidden in mobile view */}\r\n                      <Sidebar\r\n                        rooms={rooms}\r\n                        setIsRoomExist={setIsRoomExist}\r\n                        isRoomExist={isRoomExist}\r\n                      />\r\n                    </Hidden>\r\n                    <Chat isRoomExist={isRoomExist} />\r\n                  </Route>\r\n\r\n                  <Route path=\"*\">\r\n                    <Redirect to=\"/\" />\r\n                  </Route>\r\n                </Switch>\r\n              </Router>\r\n            </div>\r\n          )}\r\n        </>\r\n      ) : (\r\n        <div className=\"app__loading\">\r\n          <div>\r\n            <div className=\"app__loading_circular\">\r\n              <CircularProgress />\r\n            </div>\r\n            <div className=\"app__loading_linear\">\r\n              <LinearProgress />\r\n            </div>\r\n          </div>\r\n        </div>\r\n      )}\r\n    </div>\r\n  );\r\n}\r\n\r\nexport default App;\r\n"]},"metadata":{},"sourceType":"module"}